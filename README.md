# dnsping
ping 8.8.8.8 发现要 465 毫秒，ping VPS 140 毫秒，在 VPS 上 ping 8.8.8.8 0.2 ms

> "在200毫秒以内打开一个网页才算流畅"

这对我触动很深，因为开始做无污染DNS时.

- 在公司的网络上 ping 8.8.8.8 竟然需要 450 毫秒。
- 在公司的网络上 ping 我的一个 VPS 只要 200 毫秒。
- 在公司的网络上 ping 114.114.114.114 需要 20 毫秒。
- 在我的 VPS 上 ping 8.8.8.8 只需要 *0.2* 毫秒。

目前我的获取无污染谷歌 DNS 结果的途径有两个：

- 本地将 UDP 报文用 TCP 转发给 8.8.8.8 获取正确结果
- 本地用 ICMP 协议将 UDP 报文转发给 VPS， VPS 用 UDP 从 8.8.8.8 获取正确结果

大致时间测算：

- 本地和 8.8.8.8 建立 TCP 链接、一来一去(通常2个来回)、断开TCP链接，最短 4.5 个 ping 时长， 2秒左右
- 本地和 VPS 一次 ping 时长，大约 200 毫秒

20ms, 200ms, 2000ms, 首先发现有十倍的差距，无法令人忍受。今天听了流畅的量化标准是 200 毫秒，真是难受的无比形容。我最好的办法，光查询个 DNS 就 200 毫秒了，感觉离实际使用还有很长的路要走。
目前看来，最应该优化的方向有：

- 域名白名单，直接走 114 或者 本地DNS
- 换成香港 VPS，减少中间跳板时间
- 本地缓存 DNS 结果

本地缓存是个大问题，简单易用抄起来就打和缓存建立是个矛盾。
